---
phase: 1
plan: 1
depends_on: []
must_haves:
  - "All package.json files use @draht/ namespace"
  - "All TypeScript imports reference @draht/ packages"
  - "tsconfig references updated"
---

# Phase 1, Plan 1: Rename Packages and Update Imports

## Goal
All package names and cross-references use @draht/ namespace instead of @mariozechner/pi-*.

## Tasks

<task type="auto">
  <n>Update all package.json files</n>
  <files>package.json, packages/*/package.json, packages/web-ui/example/package.json</files>
  <action>
    Update package names in all package.json files:
    - Root: "pi-monorepo" → "draht-monorepo"
    - packages/ai: "@mariozechner/pi-ai" → "@draht/ai"
    - packages/agent: "@mariozechner/pi-agent-core" → "@draht/agent-core"
    - packages/coding-agent: "@mariozechner/pi-coding-agent" → "@draht/coding-agent"
    - packages/tui: "@mariozechner/pi-tui" → "@draht/tui"
    - packages/web-ui: "@mariozechner/pi-web-ui" → "@draht/web-ui"
    - packages/mom: "@mariozechner/pi-mom" → "@draht/mom"
    - packages/pods: "@mariozechner/pi" → "@draht/pods"
    
    Also update dependency references within each package.json (dependencies, devDependencies, peerDependencies).
    Keep @mariozechner/jiti as-is (external dependency).
    
    Use sed for bulk replacement:
    ```
    find . -name "package.json" -not -path "*/node_modules/*" -exec sed -i '' \
      -e 's/@mariozechner\/pi-ai/@draht\/ai/g' \
      -e 's/@mariozechner\/pi-agent-core/@draht\/agent-core/g' \
      -e 's/@mariozechner\/pi-coding-agent/@draht\/coding-agent/g' \
      -e 's/@mariozechner\/pi-tui/@draht\/tui/g' \
      -e 's/@mariozechner\/pi-web-ui/@draht\/web-ui/g' \
      -e 's/@mariozechner\/pi-mom/@draht\/mom/g' \
      -e 's/"@mariozechner\/pi"/"@draht\/pods"/g' \
      -e 's/"name": "pi-monorepo"/"name": "draht-monorepo"/g' \
      {} +
    ```
  </action>
  <verify>grep -r "@mariozechner/pi" --include="*.json" -l | grep -v node_modules | grep -v package-lock — should return empty (except jiti references)</verify>
  <done>All package.json files reference @draht/ namespace</done>
</task>

<task type="auto">
  <n>Update TypeScript imports</n>
  <files>All .ts files in packages/</files>
  <action>
    Bulk replace @mariozechner/pi-* imports in all TypeScript files:
    ```
    find packages/ -name "*.ts" -not -path "*/node_modules/*" -exec sed -i '' \
      -e 's/@mariozechner\/pi-ai/@draht\/ai/g' \
      -e 's/@mariozechner\/pi-agent-core/@draht\/agent-core/g' \
      -e 's/@mariozechner\/pi-coding-agent/@draht\/coding-agent/g' \
      -e 's/@mariozechner\/pi-tui/@draht\/tui/g' \
      -e 's/@mariozechner\/pi-web-ui/@draht\/web-ui/g' \
      -e 's/@mariozechner\/pi-mom/@draht\/mom/g' \
      {} +
    ```
    Note: "@mariozechner/pi" (without suffix) is the pods package but unlikely to be imported by other packages. Check and handle if needed.
  </action>
  <verify>grep -r "@mariozechner/pi-" --include="*.ts" packages/ | grep -v node_modules — should return empty</verify>
  <done>All TypeScript imports use @draht/ namespace</done>
</task>

<task type="auto">
  <n>Update tsconfig references</n>
  <files>tsconfig.json, tsconfig.base.json, packages/coding-agent/tsconfig.examples.json, packages/web-ui/example/tsconfig.json</files>
  <action>
    Update path mappings in tsconfig files that reference @mariozechner packages:
    ```
    find . -name "tsconfig*.json" -not -path "*/node_modules/*" -exec sed -i '' \
      -e 's/@mariozechner\/pi-ai/@draht\/ai/g' \
      -e 's/@mariozechner\/pi-agent-core/@draht\/agent-core/g' \
      -e 's/@mariozechner\/pi-coding-agent/@draht\/coding-agent/g' \
      -e 's/@mariozechner\/pi-tui/@draht\/tui/g' \
      -e 's/@mariozechner\/pi-web-ui/@draht\/web-ui/g' \
      -e 's/@mariozechner\/pi-mom/@draht\/mom/g' \
      {} +
    ```
  </action>
  <verify>grep -r "@mariozechner" --include="tsconfig*.json" . | grep -v node_modules — should return empty</verify>
  <done>All tsconfig files reference @draht/ packages</done>
</task>

<task type="auto">
  <n>Regenerate package-lock.json</n>
  <files>package-lock.json</files>
  <action>
    Delete package-lock.json and node_modules, then regenerate:
    ```
    rm -rf node_modules packages/*/node_modules package-lock.json
    npm install
    ```
  </action>
  <verify>npm install completes without errors</verify>
  <done>Clean dependency tree with @draht/ package names</done>
</task>
