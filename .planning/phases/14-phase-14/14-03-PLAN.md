---
phase: 14
plan: 3
depends_on: [1, 2]
must_haves:
  - "AGENTS.md templates include TDD conventions"
  - "Agent references enforce test-first ordering"
---

# Phase 14, Plan 3: TDD Agent Templates & Workflow

## Goal
Update AGENTS.md templates and agent definitions to enforce TDD.

## Tasks

<task type="auto">
  <n>1. AGENTS.md templates TDD section</n>
  <files>packages/templates/src/sst-typescript.md, packages/templates/src/astro.md, packages/templates/src/go-grpc.md</files>
  <action>
    Add a "## Testing (TDD)" section to each template:
    - SST/TS: vitest or bun:test, *.test.ts pattern, coverage with c8/istanbul
    - Astro: vitest, component testing with @testing-library, *.test.ts
    - Go/gRPC: go test, *_test.go pattern, coverage with go test -cover
    Include: "Write tests BEFORE implementation. Red → Green → Refactor."
  </action>
  <verify>Files contain TDD section</verify>
  <done>All templates have TDD conventions</done>
</task>

<task type="auto">
  <n>2. Build agent TDD enforcement</n>
  <files>~/.opencode/agents/build.md</files>
  <action>
    Update build.md to add TDD process:
    - For each task: read <test> first, write test code (expect red), then read <action>, implement (expect green), then <refactor>
    - Add rule: "If a task has no <test> block, write a test anyway before implementing"
  </action>
  <verify>build.md contains TDD instructions</verify>
  <done>Build agent enforces TDD</done>
</task>

---
Created: 2026-02-28 20:55:00
